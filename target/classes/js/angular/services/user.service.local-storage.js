define([],function(){function h(h,k,e){function l(a){var c=e.defer();a=k("filter")(f(),{username:a});c.resolve(a.length?a[0]:null);return c.promise}function f(){localStorage.users||(localStorage.users=JSON.stringify([]));return JSON.parse(localStorage.users)}var g={GetAll:function(){var a=e.defer();a.resolve(f());return a.promise},GetById:function(a){var c=e.defer();a=k("filter")(f(),{id:a});c.resolve(a.length?a[0]:null);return c.promise}};g.GetByUsername=l;g.Create=function(a){var c=e.defer();h(function(){l(a.username).then(function(b){null!==
b?c.resolve({success:!1,message:'Username "'+a.username+'" is already taken'}):(b=f(),a.id=(b[b.length-1]||{id:0}).id+1,b.push(a),localStorage.users=JSON.stringify(b),c.resolve({success:!0}))})},1E3);return c.promise};g.Update=function(a){for(var c=e.defer(),b=f(),d=0;d<b.length;d++)if(b[d].id===a.id){b[d]=a;break}localStorage.users=JSON.stringify(b);c.resolve();return c.promise};g.Delete=function(a){for(var c=e.defer(),b=f(),d=0;d<b.length;d++)if(b[d].id===a){b.splice(d,1);break}localStorage.users=
JSON.stringify(b);c.resolve();return c.promise};return g}angular.module("bookApp.services").factory("UserService",h);h.$inject=["$timeout","$filter","$q"]});
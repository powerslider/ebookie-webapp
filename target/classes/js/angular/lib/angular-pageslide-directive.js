angular.module("pageslide-directive",[]).directive("pageslide",["$document","$timeout",function(l,q){return{restrict:"EAC",transclude:!1,scope:{psOpen:"\x3d?",psAutoClose:"\x3d?",psSide:"@",psSpeed:"@",psClass:"@",psSize:"@",psSqueeze:"@",psCloak:"@",psPush:"@",psContainer:"@",psKeyListener:"@",psBodyClass:"@"},link:function(e,m,f){function h(a){if(d.bodyClass){var b=d.className+"-body";c.className=c.className.replace(new RegExp(" "+b+"-closed| "+b+"-open"),"");c.className+=" "+b+"-"+a}}function g(a,
b){if(a&&0!==a.style.width)switch(b.cloak&&k.css("display","none"),b.side){case "right":a.style.width="0px";b.squeeze&&(c.style.right="0px");b.push&&(c.style.right="0px",c.style.left="0px");break;case "left":a.style.width="0px";b.squeeze&&(c.style.left="0px");b.push&&(c.style.left="0px",c.style.right="0px");break;case "top":a.style.height="0px";b.squeeze&&(c.style.top="0px");b.push&&(c.style.top="0px",c.style.bottom="0px");break;case "bottom":a.style.height="0px",b.squeeze&&(c.style.bottom="0px"),
b.push&&(c.style.bottom="0px",c.style.top="0px")}e.psOpen=!1;b.keyListener&&l.off("keydown",n);h("closed")}function p(a,b){if(0!==a.style.width){switch(b.side){case "right":a.style.width=b.size;b.squeeze&&(c.style.right=b.size);b.push&&(c.style.right=b.size,c.style.left="-"+b.size);break;case "left":a.style.width=b.size;b.squeeze&&(c.style.left=b.size);b.push&&(c.style.left=b.size,c.style.right="-"+b.size);break;case "top":a.style.height=b.size;b.squeeze&&(c.style.top=b.size);b.push&&(c.style.top=
b.size,c.style.bottom="-"+b.size);break;case "bottom":a.style.height=b.size,b.squeeze&&(c.style.bottom=b.size),b.push&&(c.style.bottom=b.size,c.style.top="-"+b.size)}q(function(){b.cloak&&k.css("display","block")},1E3*b.speed);e.psOpen=!0;if(b.keyListener)l.on("keydown",n);h("open")}}function n(c){27===(c.keyCode||c.which)&&g(a,d)}var d={};d.side=e.psSide||"right";d.speed=e.psSpeed||"0.5";d.size=e.psSize||"300px";d.zindex=1E3;d.className=e.psClass||"ng-pageslide";d.cloak=e.psCloak&&"false"==e.psCloak.toLowerCase()?
!1:!0;d.squeeze=Boolean(e.psSqueeze)||!1;d.push=Boolean(e.psPush)||!1;d.container=e.psContainer||!1;d.keyListener=Boolean(e.psKeyListener)||!1;d.bodyClass=e.psBodyClass||!1;m.addClass(d.className);var k=null,a=null,c=d.container?document.getElementById(d.container):document.body;h("closed");a=m[0];if("div"!==a.tagName.toLowerCase()&&"pageslide"!==a.tagName.toLowerCase())throw Error("Pageslide can only be applied to \x3cdiv\x3e or \x3cpageslide\x3e elements");if(0===a.children.length)throw Error("You have to content inside the \x3cpageslide\x3e");
k=angular.element(a.children);c.appendChild(a);a.style.zIndex=d.zindex;a.style.position=!1!==d.container?"absolute":"fixed";a.style.width=0;a.style.height=0;a.style.overflow="hidden";a.style.transitionDuration=d.speed+"s";a.style.webkitTransitionDuration=d.speed+"s";a.style.transitionProperty="width, height";d.squeeze&&(c.style.position="absolute",c.style.transitionDuration=d.speed+"s",c.style.webkitTransitionDuration=d.speed+"s",c.style.transitionProperty="top, bottom, left, right");switch(d.side){case "right":a.style.height=
f.psCustomHeight||"100%";a.style.top=f.psCustomTop||"0px";a.style.bottom=f.psCustomBottom||"0px";a.style.right=f.psCustomRight||"0px";break;case "left":a.style.height=f.psCustomHeight||"100%";a.style.top=f.psCustomTop||"0px";a.style.bottom=f.psCustomBottom||"0px";a.style.left=f.psCustomLeft||"0px";break;case "top":a.style.width=f.psCustomWidth||"100%";a.style.left=f.psCustomLeft||"0px";a.style.top=f.psCustomTop||"0px";a.style.right=f.psCustomRight||"0px";break;case "bottom":a.style.width=f.psCustomWidth||
"100%",a.style.bottom=f.psCustomBottom||"0px",a.style.left=f.psCustomLeft||"0px",a.style.right=f.psCustomRight||"0px"}e.$watch("psOpen",function(c){c?p(a,d):g(a,d)});e.$watch("psSize",function(c,b){b!==c&&(d.size=c,p(a,d))});e.$on("$destroy",function(){c.removeChild(a)});e.psAutoClose&&(e.$on("$locationChangeStart",function(){g(a,d)}),e.$on("$stateChangeStart",function(){g(a,d)}))}}}]);